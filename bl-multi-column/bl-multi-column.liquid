{% comment %}
File: sections/bl-multi-column.liquid
{% endcomment %}

{{ 'bl-multi-column.css' | asset_url | stylesheet_tag }}

<div id="bl-multi-column-{{ section.id }}" class="bl-multi-column-section {{ section.settings.custom_section_class }}"
     style="
      {% if section.settings.bg_color != blank %}background-color: {{ section.settings.bg_color }};{% endif %}
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
     ">

  <style>
    #bl-multi-column-{{ section.id }} {
      {% if section.settings.bg_image != blank %}
        background-image: url({{ section.settings.bg_image | image_url }});
        background-size: {{ section.settings.bg_size }};
        background-repeat: {{ section.settings.bg_repeat }};
        background-position: center;
      {% endif %}
    }

    @media screen and (max-width: 749px) {
      #bl-multi-column-{{ section.id }} {
        {% if section.settings.bg_image_mobile != blank %}
          background-image: url({{ section.settings.bg_image_mobile | image_url }});
          background-size: {{ section.settings.bg_image_mobile_size }};
          background-repeat: {{ section.settings.bg_image_mobile_repeat }};
          background-position: center;
        {% endif %}
      }
    }
  </style>

  {% if section.settings.container_type == 'fixed' %}
    <div class="container">
  {% endif %}

    {%- comment -%}
      СЕКЦИОННЫЙ заголовок и описание
    {%- endcomment -%}
    {% if section.settings.enable_section_title or section.settings.enable_section_description %}
      <div class="section-header" style="max-width: {{ section.settings.columns_max_width }}px; margin: 0 auto;">
        {% if section.settings.enable_section_title and section.settings.section_title != blank %}
          {% assign title_tag = section.settings.section_title_tag | default: 'h2' %}
          <{{ title_tag }}
            class="section-title"
            style="text-align: {{ section.settings.section_title_align }}; margin-bottom: 0.5em;">
            {{ section.settings.section_title }}
          </{{ title_tag }}>
        {% endif %}

        {% if section.settings.enable_section_description and section.settings.section_description != blank %}
          <div class="section-description"
               style="text-align: {{ section.settings.section_description_align }}; margin-bottom: 1.25em;">
            {{ section.settings.section_description }}
          </div>
        {% endif %}
      </div>
    {% endif %}

    {% assign margin_style = '' %}
    {% if section.settings.columns_margin_align == 'center' %}
      {% assign margin_style = 'margin-left: auto; margin-right: auto' %}
    {% elsif section.settings.columns_margin_align == 'left' %}
      {% assign margin_style = 'margin-left: 0; margin-right: auto' %}
    {% elsif section.settings.columns_margin_align == 'right' %}
      {% assign margin_style = 'margin-left: auto; margin-right: 0' %}
    {% endif %}

    <div class="columns-wrapper" style=" --columns-desktop: {{ section.settings.columns_desktop }}; --columns-mobile: {{ section.settings.columns_mobile }}; max-width: {{ section.settings.columns_max_width }}px; {{ margin_style }}; ">
      {% for block in section.blocks %}
        {% assign sidebar_id = 'bl-sidebar-' | append: block.id %}
        {% assign overlay_id = 'bl-sidebar-overlay-' | append: block.id %}
        <div id="block-{{ block.id }}" class="column-item color-{{ block.settings.color_scheme }} {{ block.settings.custom_block_class }}" style="border-radius: {{ section.settings.block_radius }}px;" {{ block.shopify_attributes }}>
          {% if block.settings.enable_image and block.settings.image != blank %}
            <div class="image-wrapper">
              {{ block.settings.image | image_url: width: 600 | image_tag: class: "column-image" }}
            </div>
          {% endif %}

          <div class="content-wrapper">
          {% if block.settings.enable_title and block.settings.title != blank %}
            {% assign tag = block.settings.title_tag | default: 'h2' %}
            <{{ tag }} style="text-align: {{ block.settings.title_align }};">{{ block.settings.title }}</{{ tag }}>
          {% endif %}
          {% if block.settings.enable_content and block.settings.content != blank %}
            <div class="rte" style="text-align: {{ block.settings.content_align }};">{{ block.settings.content }}</div>
          {% endif %}
          {% if block.settings.enable_custom_html and block.settings.custom_html != blank %}
            <div class="custom-html">
              {{ block.settings.custom_html }}
            </div>
          {% endif %}
          {% if block.settings.button_text != blank %}
            <div style="text-align: {{ block.settings.button_align }};">
              {% if block.settings.enable_sidebar %}
                <button type="button"
                  class="btn {% if block.settings.use_outline_button %}btn--border{% else %}btn--fill{% endif %}"
                  onclick="document.getElementById('{{ sidebar_id }}').classList.add('active'); document.getElementById('{{ overlay_id }}').classList.add('active')">
                  {{ block.settings.button_text }}
                </button>
              {% elsif block.settings.link != blank %}
                <a
                  class="btn {% if block.settings.use_outline_button %}btn--border{% else %}btn--fill{% endif %}"
                  href="{{ block.settings.link }}"
                  target="{{ block.settings.link_target }}">
                  {{ block.settings.button_text }}
                </a>
              {% endif %}
            </div>
          {% endif %}
          </div>

          {% if block.settings.enable_sidebar %}
            <div id="{{ sidebar_id }}" class="bl-sidebar">
              <span class="bl-sidebar-close" onclick="document.getElementById('{{ sidebar_id }}').classList.remove('active'); document.getElementById('{{ overlay_id }}').classList.remove('active')">&times;</span>

              {% if block.settings.sidebar_enable_image and block.settings.sidebar_image != blank %}
                {{ block.settings.sidebar_image | image_url: width: 300 | image_tag }}
              {% endif %}
              {% if block.settings.sidebar_enable_title and block.settings.sidebar_title != blank %}
                <h3>{{ block.settings.sidebar_title }}</h3>
              {% endif %}
              {% if block.settings.sidebar_enable_content and block.settings.sidebar_content != blank %}
                <div class="rte">{{ block.settings.sidebar_content }}</div>
              {% endif %}
              {% if block.settings.sidebar_enable_button and block.settings.sidebar_button_text != blank and block.settings.sidebar_button_link != blank %}
                <a
                  class="btn {% if block.settings.sidebar_button_outline %}btn--border{% else %}btn--fill{% endif %}"
                  href="{{ block.settings.sidebar_button_link }}"
                  target="{{ block.settings.sidebar_button_target }}">
                  {{ block.settings.sidebar_button_text }}
                </a>
              {% endif %}
            </div>

            <div id="{{ overlay_id }}" class="bl-sidebar-overlay" onclick="document.getElementById('{{ sidebar_id }}').classList.remove('active'); this.classList.remove('active')"></div>
          {% endif %}
        </div>
      {% endfor %}
    </div>

  {% if section.settings.container_type == 'fixed' %}
    </div>
  {% endif %}
</div>

{% schema %}
{
  "name": "Bilamina Multi Column",
  "settings": [
    {
      "type": "range",
      "id": "columns_desktop",
      "label": "Columns on desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "label": "Columns on mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 1
    },
    {
      "type": "select",
      "id": "container_type",
      "label": "Container width",
      "options": [
        { "label": "Fixed width", "value": "fixed" },
        { "label": "Full width", "value": "full" }
      ],
      "default": "fixed"
    },

    { "type": "header", "content": "Section header" },
    { "type": "checkbox", "id": "enable_section_title", "label": "Show section title", "default": false },
    { "type": "text", "id": "section_title", "label": "Section title", "default": "Section title" },
    {
      "type": "select",
      "id": "section_title_tag",
      "label": "Section title tag",
      "default": "h2",
      "options": [
        { "label": "H1", "value": "h1" },
        { "label": "H2", "value": "h2" },
        { "label": "H3", "value": "h3" },
        { "label": "H4", "value": "h4" },
        { "label": "H5", "value": "h5" },
        { "label": "H6", "value": "h6" }
      ]
    },
    {
      "type": "select",
      "id": "section_title_align",
      "label": "Section title alignment",
      "default": "center",
      "options": [
        { "label": "Left", "value": "left" },
        { "label": "Center", "value": "center" },
        { "label": "Right", "value": "right" }
      ]
    },

    { "type": "checkbox", "id": "enable_section_description", "label": "Show section description", "default": false },
    {
      "type": "html",
      "id": "section_description",
      "label": "Section description (HTML)",
      "default": "<p>Add an optional description for this section.</p>"
    },
    {
      "type": "select",
      "id": "section_description_align",
      "label": "Section description alignment",
      "default": "center",
      "options": [
        { "label": "Left", "value": "left" },
        { "label": "Center", "value": "center" },
        { "label": "Right", "value": "right" }
      ]
    },

    {
      "type": "range",
      "id": "columns_max_width",
      "label": "Max width for columns (px)",
      "min": 0,
      "max": 1600,
      "step": 50,
      "default": 1600
    },
    {
      "type": "select",
      "id": "columns_margin_align",
      "label": "Columns horizontal alignment",
      "options": [
        { "label": "Left", "value": "left" },
        { "label": "Center", "value": "center" },
        { "label": "Right", "value": "right" }
      ],
      "default": "center"
    },
    {
      "type": "text",
      "id": "custom_section_class",
      "label": "Custom section class"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "image_picker",
      "id": "bg_image",
      "label": "Background image"
    },
    {
      "type": "select",
      "id": "bg_size",
      "label": "Background size",
      "options": [
        { "label": "Cover", "value": "cover" },
        { "label": "Contain", "value": "contain" }
      ],
      "default": "cover"
    },
    {
      "type": "select",
      "id": "bg_repeat",
      "label": "Background repeat",
      "options": [
        { "label": "No repeat", "value": "no-repeat" },
        { "label": "Repeat", "value": "repeat" }
      ],
      "default": "no-repeat"
    },
    {
      "type": "image_picker",
      "id": "bg_image_mobile",
      "label": "Background image (mobile)"
    },
    {
      "type": "select",
      "id": "bg_image_mobile_size",
      "label": "Background size (mobile)",
      "options": [
        { "label": "Cover", "value": "cover" },
        { "label": "Contain", "value": "contain" }
      ],
      "default": "cover"
    },
    {
      "type": "select",
      "id": "bg_image_mobile_repeat",
      "label": "Background repeat (mobile)",
      "options": [
        { "label": "No repeat", "value": "no-repeat" },
        { "label": "Repeat", "value": "repeat" }
      ],
      "default": "no-repeat"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top (px)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom (px)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40
    },
    {
      "type": "range",
      "id": "block_radius",
      "label": "Block border radius (px)",
      "min": 0,
      "max": 50,
      "step": 2,
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "Bilamina Multi Column"
    }
  ],
  "max_blocks": 6,
  "blocks": [
    {
      "type": "column",
      "name": "Column",
      "settings": [
        {
          "type": "text",
          "id": "custom_section_class",
          "label": "Custom section class"
        },
        { "type": "checkbox", "id": "enable_image", "label": "Show image", "default": true },
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "checkbox", "id": "enable_title", "label": "Show title", "default": true },
        { "type": "text", "id": "title", "label": "Title", "default": "Title" },
        {
          "type": "select",
          "id": "title_tag",
          "label": "Heading tag",
          "default": "h2",
          "options": [
            { "label": "H1", "value": "h1" },
            { "label": "H2", "value": "h2" },
            { "label": "H3", "value": "h3" },
            { "label": "H4", "value": "h4" },
            { "label": "H5", "value": "h5" },
            { "label": "H6", "value": "h6" }
          ]
        },
        {
          "type": "select",
          "id": "title_align",
          "label": "Title alignment",
          "default": "center",
          "options": [
            { "label": "Left", "value": "left" },
            { "label": "Center", "value": "center" },
            { "label": "Right", "value": "right" }
          ]
        },
        { "type": "checkbox", "id": "enable_content", "label": "Show content", "default": true },
        { "type": "richtext", "id": "content", "label": "Content", "default": "<p>Brief description of this block.</p>" },
        {
          "type": "select",
          "id": "content_align",
          "label": "Content alignment",
          "default": "center",
          "options": [
            { "label": "Left", "value": "left" },
            { "label": "Center", "value": "center" },
            { "label": "Right", "value": "right" }
          ]
        },
        {
          "type": "checkbox",
          "id": "enable_custom_html",
          "label": "Show custom HTML",
          "default": false
        },
        {
          "type": "html",
          "id": "custom_html",
          "label": "Custom HTML"
        },
        { "type": "text", "id": "button_text", "label": "Button text", "default": "Learn More" },
        {
          "type": "select",
          "id": "button_align",
          "label": "Button alignment",
          "default": "center",
          "options": [
            { "label": "Left", "value": "left" },
            { "label": "Center", "value": "center" },
            { "label": "Right", "value": "right" }
          ]
        },
        { "type": "url", "id": "link", "label": "Link" },
        { "type": "select", "id": "link_target", "label": "Open link in", "options": [ { "label": "New tab", "value": "_blank" }, { "label": "Same tab", "value": "_top" } ], "default": "_top" },
        { "type": "checkbox", "id": "use_outline_button", "label": "Use outline button", "default": false },
        { "type": "checkbox", "id": "enable_sidebar", "label": "Enable sidebar for this block", "default": false },
        { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" },
        { "type": "checkbox", "id": "sidebar_enable_image", "label": "Show image in sidebar", "default": true },
        { "type": "image_picker", "id": "sidebar_image", "label": "Sidebar image" },
        { "type": "checkbox", "id": "sidebar_enable_title", "label": "Show title in sidebar", "default": true },
        { "type": "text", "id": "sidebar_title", "label": "Sidebar title", "default": "Sidebar Title" },
        { "type": "checkbox", "id": "sidebar_enable_content", "label": "Show content in sidebar", "default": true },
        { "type": "richtext", "id": "sidebar_content", "label": "Sidebar content", "default": "<p>Sidebar description goes here.</p>" },
        { "type": "checkbox", "id": "sidebar_enable_button", "label": "Show button in sidebar", "default": true },
        { "type": "text", "id": "sidebar_button_text", "label": "Sidebar button text", "default": "Learn More" },
        { "type": "url", "id": "sidebar_button_link", "label": "Sidebar button link" },
        { "type": "select", "id": "sidebar_button_target", "label": "Open sidebar button link in", "options": [ { "label": "New tab", "value": "_blank" }, { "label": "Same tab", "value": "_top" } ], "default": "_top" },
        { "type": "checkbox", "id": "sidebar_button_outline", "label": "Use outline button in sidebar", "default": false }
      ]
    }
  ]
}
{% endschema %}
